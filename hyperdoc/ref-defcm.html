<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- XML file produced from file: reference.tex
     using Hyperlatex v 2.9-in-waiting-rk (c) Otfried Cheong -->
<head>
<title>GBBopen 1.0 Reference -- defcm</title>
</p>
<link rel="SHORTCUT ICON" href="favicon.ico"><link rel=stylesheet
        href="gbbopen.css" type="text/css" />
</head>
<body>
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="ref-delq.html"><img border="0" alt="delq" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="ref-tools-entities.html"><img border="0" alt="Tools" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="ref-define-class.html"><img border="0" alt="define-class" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b><font color="#000000">defcm</font></b></td><td bgcolor="#99ccff"><a target="_top" href="reference.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table>

<p><table class="tight" width="100%">
<tr valign="top"><td valign="baseline" align="left"%>
<nobr><b><font color="#000000">defcm</font></b></nobr></td><td valign="baseline"> &nbsp; </td><td valign="baseline" align="left" width="99%"><var>name lambda-list</var> 
[[<var>declaration</var>*&nbsp;|&nbsp;<var>documentation</var>]]
<var>form</var>*<i> =&gt; </i> <var>name</var></td><td valign="baseline" align="right">[<i>Macro</i>]
</td></tr></table></p>
<p><span class="fndoclabel">Purpose</span> <br />Define a read-time conditional compiler macro.
</p>
<p><span class="fndoclabel">Package</span>&nbsp;&nbsp;&nbsp;<code>:gbbopen-tools</code>
</p>
<p><span class="fndoclabel">Module</span>&nbsp;&nbsp;&nbsp;<code>:gbbopen-tools</code>
</p>
<p><span class="fndoclabel">Arguments and values</span><table class="tighttop">
<tr valign="top"><td valign="baseline"><i>name</i></td><td valign="baseline">&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="baseline"> A non-<code>nil</code>, <a href="ref-glossary.html#id125">non-keyword&nbsp;symbol</a> that names a function or macro
</td></tr><tr valign="top"><td valign="baseline"><i>lambda-list</i></td><td valign="baseline">&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="baseline"> A lambda-list
</td></tr><tr valign="top"><td valign="baseline"><i>declaration</i></td><td valign="baseline">&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="baseline"> A declare expression (not evaluated)
</td></tr><tr valign="top"><td valign="baseline"><i>documentation</i></td><td valign="baseline">&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="baseline"> A documentation string (not evaluated)
</td></tr><tr valign="top"><td valign="baseline"><i>form</i></td><td valign="baseline">&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="baseline"> A <a href="ref-glossary.html#gl:form">form</a>
</td></tr></table>
</p>
<p><span class="fndoclabel">Returns</span> <br />The supplied <var>name</var>.
</p>
<p><span class="fndoclabel">Description</span> <br /><b>Defcm</b> is a read-time conditional version of Common Lisp's
<code>define-compiler-macro</code>.  As with <code>define-compiler-macro</code>:
</p>
<p><ul class="tight"><li>The expander function is installed as a compiler macro function for
<var>name</var>.
<li>The <code>&#38;whole</code> argument is bound to the form argument that is passed
to <b>defcm</b>. The remaining <var>lambda-list</var> parameters are
specified as if this form contained the function name in the car and the
actual arguments in the cdr.  However, if the car of the actual form is the
symbol <code>funcall</code>, then the destructuring of the arguments is actually
performed using its cddr instead.
<li>Documentation is attached as a documentation string to name (as kind
<code>compiler-macro</code>) and to the compiler macro function.
<li>A compiler macro can decline to provide an expansion merely by returning
the original form (which can be obtained by using <code>&#38;whole</code>).
</ul>
A compiler macro is not defined if the feature
<b><a href="ref-disable-compiler-macros.html">:disable-compiler-macros</a></b> or the feature
<b><a href="ref-full-safety.html">:full-safety</a></b> is present when the expander function is
executed on a form.
</p>
<p><span class="fndoclabel">See also</span>
<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="ref-disable-compiler-macros.html"><b>:disable-compiler-macros</b></a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="ref-full-safety.html"><b>:full-safety</b></a>
</p>
<p><span class="fndoclabel">Example</span> <br /><a name="id1">Here</a> is the compiler macro defined for <b><a href="ref-ensure-list.html">ensure-list</a></b>:
<pre class="pretop">
&gt; (defcm ensure-list (x)
    (<a href="ref-with-once-only-bindings.html">with-once-only-bindings</a> (x)
      `(if (listp ,x) ,x (list ,x))))
ensure-list
</pre>
</p>
<hr /><address><a target="_top" class="address"
    href="http://GBBopen.org/"><p>The GBBopen Project</a></address><br />
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="ref-delq.html"><img border="0" alt="delq" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="ref-tools-entities.html"><img border="0" alt="Tools" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="ref-define-class.html"><img border="0" alt="define-class" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b><font color="#000000">defcm</font></b></td><td bgcolor="#99ccff"><a target="_top" href="reference.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table></body></html>
