<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- XML file produced from file: tutorial.tex
     using Hyperlatex v 2.9-in-waiting-rk (c) Otfried Cheong -->
<head>
<title>GBBopen 0.9.5 Tutorial -- Creating a Space Instance</title>
</p>
<link rel="SHORTCUT ICON" href="favicon.ico"><link rel=stylesheet
        href="gbbopen.css" type="text/css" />
</head>
<body>
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="tutorial-creating-a-unit-instance.html"><img border="0" alt="Creating a Unit Instance" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="tutorial_0.html"><img border="0" alt="Top" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="tutorial-deleting-instances.html"><img border="0" alt="Deleting Instances" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b>Creating a Space Instance</b></td><td bgcolor="#99ccff"><a target="_top" href="tutorial.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table>
<h1>Creating a Space Instance</h1>
<p>In GBBopen, <i>space instances</i> serve as containers for unit instances.
As we saw in the last exercise, unit instances need not be placed in a space
instance.  They are perfectly useful on their own.  In this exercise we will
create a space instance and add and remove unit instances from it.  A unit
instance can also be contained in multiple space instances at the same time.
Although containment &#8220;in&#8221; a space instance is a more technically correct
phrase, historically developers talk of unit instances being &#8220;on&#8221; a space
instance or of adding a unit instance &#8220;to&#8221; a space instance.  Whichever
preposition is used, the meaning is the same.
</p>
<p>As with unit instances, each space instance is a member of a <i>space
class</i>.  The space class defines the structure of all instances of the space
class, such as any slots associated with each space instance.  Unlike unit
instances, however, the standard GBBopen space class,
<code>standard-space-instance</code>, is often sufficient for most applications.
Therefore, space-instance subclasses rarely need to be defined.
</p>
<p>Space instances can be organized into hierarchical structures, much like the
directories in a hierarchical file system.  A useful, but not exact, analogy
is to think of unit instances as being similar to files and space instances as
similar to directories.  Stretching this analogy one step further, adding a
unit instance to a space instance is akin to creating a symbolic link to a
file in a directory.  Removing the unit instance from the space instance is
like removing the symbolic link: the unit instance itself, like the file, is
not deleted by the removal.
</p>
<p><hr color="99CCCC">
This exercise shows you how to:
</p>
<p><ul class="tight"><li>Create a space instance
<li>Find a space instance by its path
<li>Add and remove a unit instance from the space instance
<li>Display a description of the blackboard repository
<li>Find unit instances on a space instance
</ul>
</p>
<hr color="99CCCC">
<h2><a name="id1">Prerequisites</a></h2><p>
If you ended the Common Lisp session used in the last exercise, begin a new
session and evaluate the following forms:
</p>
<pre><font color="#8c8c8c"> &gt; <font color="#000000">(load "<var>&lt;install-directory&gt;</var>startup.lisp")</font>
     ...
  &gt; <font color="#000000">(mini-module:compile-module :gbbopen-user :propagate :create-dirs)</font>
     ...
  &gt; <font color="#000000">(in-package :gbbopen-user)</font>
  #&lt;The gbbopen-user package&gt;
  &gt; <font color="#000000">(define-unit-class location ()
      (x y))</font>
  #&lt;location&gt;
  &gt; <font color="#000000">(defparameter ui (make-instance 'location :x 40 :y 60))</font>
  ui
  &gt;
</pre></font>
<h2><a name="id2">Step 1: Create a space instance</a></h2><p>
Create a <i>space instance</i> named <code>known-world</code>.  To simplify
access to the space instance during subsequent activities, first define a
global variable called <code>si</code> by entering the following form:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(defvar si)</font>
  si
  &gt;
</pre></font>
<p><a name="id3">Now,</a> create the space instance and assign it to the variable <code>si</code> by
entering the form:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(setf si (make-space-instance '(known-world)))</font>
  #&lt;standard-space-instance (known-world)&gt;
  &gt;
</pre></font>
<p>The argument to the <b>make-space-instance</b> is the &#8220;path&#8221; to be used
for the created space instance.  A <i>space-instance path</i> is the
complete list of space-instance names, starting with the name of the most
distant indirect parent, that uniquely identifies a space instance in the
blackboard repository.  Our <code>known-world</code> space does not have a parent,
so its path is simply <code>(known-world)</code>.
</p>
<h2><a name="id4">Step 2: Display a description of the blackboard repository</a></h2><p>
Display a description of the blackboard repository, which now contains the
<code>known-world</code> space instance:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(describe-blackboard-repository)</font>
  
  Space Instance                Contents
  --------------                --------
  known-world                   Empty

  Unit Class                    Instances
  ----------                    ---------
  location                              1
  standard-space-instance               1
  &gt;
</pre></font>
<p>The description indicates that:
</p>
<p><ul class="tight"><li>One space instance, <code>known-world</code>, exists in the repository
<li>The <code>known-world</code> space instance is empty; there are no unit
instances stored in it
<li>The <code>location</code> unit instance exists, but it does not reside
on any space instance
<li>There is one <code>standard-space-instance</code>, our
<code>known-world</code> space instance, which also does not reside
on any space instance
</ul>
</p>
<h2><a name="id5">Step 3: Find a space instance by its path</a></h2><p>
You can look up a particular space instance by its space-instance path:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(find-space-instance-by-path '(known-world))</font>
  #&lt;standard-space-instance (known-world)&gt;
  &gt;
</pre></font>
<p>We assigned the <code>known-world</code> space instance to the global variable
<code>si</code>, but it is nice to know that we can always find it again using its
path.
</p>
<h2><a name="id6">Step 4: Add the unit instance to the space instance</a></h2><p>
Now, add the <code>location</code> unit instance to the space instance.
Enter the following form:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(add-instance-to-space-instance ui si)</font>
  #&lt;location 1&gt;
  &gt;
</pre></font>
<h2><a name="id7">Step 5: Again, display the blackboard-repository description</a></h2><p>
Display the description of the blackboard repository again:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(describe-blackboard-repository)</font>
  
  Space Instance                Contents
  --------------                --------
  known-world                   1 instance (1 location)

  Unit Class                    Instances
  ----------                    ---------
  location                              1
  standard-space-instance               1
  &gt;
</pre></font>
<p>This time the description indicates that the <code>known-world</code> space instance
has one instance of the <code>location</code> unit class stored on it.
</p>
<h2><a name="id8">Step 6: Display the description of the unit instance</a></h2><p>
Display the description of the <code>location</code> unit instance once again,
observing the change in the space instances from the last exercise:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(describe-instance ui)</font>
  Location #&lt;location 1&gt;
    Instance name: 1
    Space instances: ((known-world))
    Dimensional values: None
    Non-link slots:
      x 50
      y 60
    Link slots:
      [None]
  &gt;
</pre></font>
<h2><a name="id9">Step 7: Find the unit instance on the space instance</a></h2><p>
Now that the <code>location</code> unit instance is on the <code>known-world</code> space
instance, we can find it on the space instance. The form is as follows,
where <code>:all</code> is a very basic retrieval pattern specifying that all unit
instances on the <code>known-world</code> space instance are to be returned:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(find-instances 'location '(known-world) :all)</font>
  (#&lt;location 1&gt;)
  &gt;
</pre></font>
<p>The list of found unit instances is returned. (In this case, there is only one
in the list.)
</p>
<p>This is a very simple retrieval; however, GBBopen can perform extremely
complex searches as well.  We will use more complex retrieval patterns in
upcoming exercises.
</p>
<h2><a name="id10">Step 8: Add another unit instance to the space instance</a></h2><p>
Create a second instance of the <code>location</code> unit class, with <code>x</code> and
<code>y</code> slot values 80 and 90, respectively, and add it to the
<code>known-world</code> space instance:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(add-instance-to-space-instance 
       (make-instance 'location :x 80 :y 90)
       si)</font>
  #&lt;location 2&gt;
  &gt;
</pre></font>
<p><a name="id11">This</a> time we did not assign the new <code>location</code> unit instance to a global
variable but, as before, we can find the unit instance by its name:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(find-instance-by-name 2 'location)</font>
  #&lt;location 2&gt;
  &gt;
</pre></font>
<p><a name="id12">As</a> you would expect, we can retrieve both <code>location</code> unit instances from the
<code>known-world</code> space instance using <b>find-instances</b>:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(find-instances 'location '(known-world) :all)</font>
  (#&lt;location 2&gt; #&lt;location 1&gt;)
  &gt;
</pre></font>
<h2><a name="id13">Step 9: Again, display the blackboard-repository description</a></h2><p>
Display the description of the blackboard repository again:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(describe-blackboard-repository)</font>
  
  Space Instance                Contents
  --------------                --------
  known-world                   2 instances (2 location)
  &gt;
</pre></font>
<p>This time the description indicates that the <code>known-world</code> space instance
has both instances of the <code>location</code> unit class stored on it.
</p>
<h2><a name="id14">Step 10:  Remove a unit instance from the space instance</a></h2><p>
Now, remove the first <code>location</code> unit instance from the
<code>known-world</code> space instance.  Enter the following form:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(remove-instance-from-space-instance ui si)</font>
  #&lt;location 1&gt;
  &gt;
</pre></font>
<p><a name="id15">As</a> you would expect, only the second <code>location</code> unit instance remains on the
<code>known-world</code> space instance:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(find-instances 'location '(known-world) :all)</font>
  (#&lt;location 2&gt;)
  &gt;
</pre></font>
<p>and describing the <code>location</code> unit instance confirms this:
</p>
<pre><font color="#8c8c8c">  &gt; <font color="#000000">(describe-instance ui)</font>
  Location #&lt;location 1&gt;
    Instance name: 1
    Space instances: None
    Dimensional values: None
    Non-link slots:
      x 50
      y 60
    Link slots:
      [None]
  &gt;
</pre></font>
<hr /><address><a target="_top" class="address"
    href="http://GBBopen.org/"><p>The GBBopen Project</a></address><br />
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="tutorial-creating-a-unit-instance.html"><img border="0" alt="Creating a Unit Instance" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="tutorial_0.html"><img border="0" alt="Top" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="tutorial-deleting-instances.html"><img border="0" alt="Deleting Instances" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b>Creating a Space Instance</b></td><td bgcolor="#99ccff"><a target="_top" href="tutorial.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table></body></html>
