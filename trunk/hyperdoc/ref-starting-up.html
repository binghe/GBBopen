<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- XML file produced from file: reference.tex
     using Hyperlatex v 2.9-in-waiting-rk (c) Otfried Cheong -->
<head>
<title>GBBopen 0.9.7 Reference -- Starting Up</title>
</p>
<link rel="SHORTCUT ICON" href="favicon.ico"><link rel=stylesheet
        href="gbbopen.css" type="text/css" />
</head>
<body>
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="ref-acknowledgments.html"><img border="0" alt="Acknowledgments" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="reference_0.html"><img border="0" alt="Top" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="ref-mini-module-entities.html"><img border="0" alt="Mini-Module System" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b>Starting Up</b></td><td bgcolor="#99ccff"><a target="_top" href="reference.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table>
<h1>Starting Up</h1>
<p>GBBopen is packaged with its own <a href="ref-mini-module-entities.html">module
system</a> that supports compiling and loading GBBopen
components.  This mini-module facility is designed for ease of use and
for simplicity in porting to Common Lisp implementations.  For
example, to compile all core GBBopen modules and execute a basic
trip-tests file, you only need to evaluate the following forms within
your Common Lisp environment:
</p>
<pre>
&gt; (load "<var>&lt;install-directory&gt;</var>startup.lisp")
; Loading <var>&lt;install-directory&gt;</var>/startup.lisp
;  Loading <var>&lt;install-directory&gt;</var>/source/mini-module/mini-module-loader.lisp
;   Loading <var>&lt;install-directory&gt;</var>/source/mini-module/mini-module.lisp
;  Loading <var>&lt;install-directory&gt;</var>/source/modules.lisp
T
&gt; (mini-module:<a href="ref-compile-module.html">compile-module</a> :gbbopen-test :propagate :create-dirs)
; Compiling <var>&lt;install-directory&gt;</var>/source/mini-module/mini-module.lisp
     ...
;; Running basic GBBopen tests...
     ...
</pre>
<p>GBBopen should compile, load, and run the basic tests file without error.
</p>
<p><a name="id1">If</a> you are running GBBopen on Windows, note that backslash is the
escape character in the standard Common Lisp reader; it causes the
next character to treated as a normal character rather than as having
any special syntactic characteristics. So, each backslash in a
file-specification string must be entered as two backslash characters.
For example:
</p>
<pre>
&gt; (load "c:\\GBBopen\\startup.lisp")
</pre>
<p>As can be seen from the file-loading messages, the <code>startup.lisp</code>
file loads a bootstrap loader file for the module facility (the file
<code>source/mini-module/mini-module-loader.lisp</code>).  This bootstrap
file then loads the module system file
(<code>source/mini-module/mini-module.lisp</code>) followed by the module
definitions for all GBBopen modules (contained in the file
<code>source/modules.lisp</code>).
</p>
<p><a name="id2">The</a> <code>:propagate</code> option to <b><a href="ref-compile-module.html">compile-module</a></b> causes
any file in the required modules to be compiled if its binary file does not
exist or is not up to date.  The <code>:create-dirs</code> option automatically
creates any directories that are missing in the compiled-file directory tree.
</p>
<p><h4>Personal gbbopen-init.lisp file</h4>
</p>
<p><a name="id3">If</a> a <code>gbbopen-init.lisp</code> file (source or compiled) is present in
the user's &#8220;home&#8221; directory (as defined by
<b>user-homedir-pathname</b>), it is loaded by the
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>startup.lisp</code> file after the
module facility and definitions have been loaded.  A personal
<code>gbbopen-init.lisp</code> file is a handy mechanism for defining
user-specific modules, application modules, GBBopen parameters, and
other personalizations.
</p>
<p>Here is a simple example of a personal <code>gbbopen-init.lisp</code> file
that defines a root directory named <code>:my-app-root</code> and the module
<code>:my-app</code>:
</p>
<pre>
  ;;;; -*- Mode:Common-Lisp; Package:CL-USER -*-

  (in-package :cl-user)

  (mini-module:<a href="ref-define-root-directory.html">define-root-directory</a> :my-app-root 
      (make-pathname :directory "~/my-app"))    

  (mini-module:<a href="ref-define-module.html">define-module</a> :my-app
    (:requires :gbbopen-user)
    (:directory :my-app-root)
    (:files "my-file"))

  ;;; ===============================================
  ;;;   End of File
  ;;; ===============================================
</pre>
<p>For shared or more substantial application modules, we recommend a
packaging convention that mirrors that of GBBopen.  This will be
discussed shortly in conjunction with using a <a href="#sec:personal-gbbopen-modules-directory">personal
<code>gbbopen-modules</code>
directory</a>.
</p>
<p>Next, we show how to add convenient GBBopen keyword commands to the
read-eval-print loop (REPL) in your Common Lisp environment and how to
define a personal top-level command that makes it easy to compile and load
the <code>:my-app</code> module&mdash;even if GBBopen has not yet been loaded into
your Common Lisp image.
</p>
<p><h4>GBBopen top-level commands</h4>
<a name="id4">The</a> file<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>gbbopen-init.lisp</code> is an
alternative for <var><i>&lt;</i>install-directory<i>&gt;</i></var><code>startup.lisp</code> that adds
some handy GBBopen keyword commands to the top-level REPL listener for
<a target="_top" href="http://www.franz.com">Allegro CL</a>,
<a target="_top" href="http://clisp.cons.org/">CLISP</a>,
<a target="_top" href="http://trac.clozure.com/openmcl/">Clozure CL</a>,
<a target="_top" href="http://www.cons.org/cmucl/">CMUCL</a>,
<a target="_top" href="http://common-lisp.net/project/ecl/">ECL</a>,
<a target="_top" href="http://www.lispworks.com">LispWorks</a>,
<a target="_top" href="http://openmcl.clozure.com/">OpenMCL</a>,
<a target="_top" href="http://sbcl.sourceforge.net">SBCL</a> and
<a target="_top" href="http://www.scieneer.com/scl/">Scieneer CL</a>
users.  Some interaction
interfaces, such as <a target="_top" href="http://common-lisp.net/project/slime/">SLIME</a>,
use their own REPL rather than the top-level listener
provided by the Common Lisp implementation and, therefore, may not support
keyword top-level command processing.  GBBopen does provide a swank extension
in the <a target="_top" href="http://common-lisp.net/project/slime/">SLIME</a> REPL that
supports GBBopen keyword commands.
</p>
<p>To make GBBopen keyword commands available, simply load
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>gbbopen-init.lisp</code> from your personal
Common Lisp initialization file.  (You should not explicitly load the
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>startup.lisp</code> file when using
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>gbbopen-init.lisp</code>&mdash;it will handle the
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>startup.lisp</code> file loading for you.)
</p>
<p>The standard GBBopen top-level commands are defined in the file
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>commands.lisp</code>. 
In many Common Lisp implementations, top-level keyword commands that have
arguments can be specified using either a list or a spread representation.
For example:
</p>
<pre>
&gt; (:gbbopen-test :create-dirs)
</pre>
<p>or
</p>
<pre>
&gt; :gbbopen-test :create-dirs
</pre>
<p>However, <a target="_top" href="http://trac.clozure.com/openmcl/">Clozure CL</a>,
<a target="_top" href="http://openmcl.clozure.com/">OpenMCL</a>, and the
<a target="_top" href="http://common-lisp.net/project/slime/">SLIME</a> REPL interface do not
support the spread representation, and <a target="_top" href="http://www.franz.com">Allegro
CL</a> and
<a target="_top" href="http://www.lispworks.com">LispWorks</a> do not support the list
representation.  <a target="_top" href="http://clisp.cons.org/">CLISP</a> also does not
support the list representation and currently does not support command
arguments in its native REPL.
</p>
<p>Equivalent functions in the <code>:common-lisp-user</code> package are always
defined for each GBBopen top-level keyword command, and these functions can be
used when top-level keyword processing is not fully supported.
</p>
<p><h4>Personal gbbopen-commands.lisp file</h4>
<a name="id5">You</a> can add your own top-level commands by defining them in a personal
<code>gbbopen-commands.lisp</code> file.  If a <code>gbbopen-commands</code> file (source
or compiled) is present in the user's home directory (as defined by
<b>user-homedir-pathname</b>), it is loaded automatically by GBBopen's
<code>gbbopen-init.lisp</code> file.  For example, the following personal
<code>gbbopen-commands.lisp</code> file defines a top-level keyword command (named
<code>:my-app</code>) and an equivalent <a href="ref-glossary.html#gl:function">function</a> (<code>cl-user::my-app</code>)
for compiling and loading the <code>:my-app</code> module that was defined above:
</p>
<pre>
  ;;;; -*- Mode:Common-Lisp; Package:CL-USER -*-

  (in-package :cl-user)

  (<a href="ref-define-tll-command.html">define-tll-command</a> :my-app (&amp;rest options)
    "Compile and load my GBBopen application module"
    (<a href="ref-startup-module.html">startup-module</a> :my-app options :gbbopen-user))

  ;;; ===============================================
  ;;;   End of File
  ;;; ===============================================
</pre>
<p>The macro <code>define-tll-command</code> and the <a href="ref-glossary.html#gl:function">function</a> <code>startup-module</code>
that are used in this example are both defined in the file
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>gbbopen-init.lisp</code>.  Most GBBopen users
prefer to have their Common Lisp initialization file load
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>gbbopen-init.lisp</code> rather than
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>startup.lisp</code> in order to use the
standard keyword commands for GBBopen&mdash;and their own, personalized
extensions&mdash;in the Lisp listener.
</p>
<p><h4>Personal gbbopen-modules directory</h4>
<a name="sec:personal-gbbopen-modules-directory"></a>
</p>
<p><a name="id7">Earlier,</a> we showed a simple example of using a personal
<code>gbbopen-init.lisp</code> file to define the module <code>:my-app</code>.  If you
develop or use a number of modules or applications, GBBopen provides an
alternative mechanism that is even more convenient.
</p>
<p>If a <code>gbbopen-modules</code> directory is present in the user's home
directory (as defined by <b>user-homedir-pathname</b>), it is
assumed to contain symbolic links (or &#8220;pseudo symbolic-link&#8221; files on
Windows) to individual GBBopen module directory trees.  Each module
directory tree can contain:
</p>
<p><ul class="tight"><li>a <code>commands.lisp</code> file that specifies top-level commands for the
module (loaded after the personal <code>gbbopen-commands.lisp</code> file
if there is one in the user's home directory)
<li>a <code>modules.lisp</code> file that contains module definitions (loaded
after the personal <code>gbbopen-init.lisp</code> file if there is one in the
user's home directory)
<li>a directory named <code>source</code> containing all the additional source
files for the module or application
</ul>
</p>
<p>We highly recommend following this packaging convention, which mirrors
that of GBBopen itself. It is very easy to create, use,  and share modules
defined in this way by placing symbolic links to the module
directories in your personal <code>gbbopen-modules</code> directory.
Windows, unfortunately, is the exception to this as Windows does not
provide symbolic links.  GBBopen users running on Windows must create
a text file of type <code>.sym</code> (containing target directory path as
its sole line) as a stand-in for the symbolic link. 
</p>
<p><h4>GBBopen Hyperdoc</h4>
<a name="sec:hyperdoc">
Convenient</a> access to a local copy of the GBBopen Hyperdoc manual from Common
Lisp is available by using the <b><a href="ref-browse-hyperdoc.html">browse-hyperdoc</a></b> function;
part of the <a href="ref-os-interface-entities.html"><code>:os-interface</code></a> module. The
browser used by <b><a href="ref-browse-hyperdoc.html">browse-hyperdoc</a></b> is specified by the value
of <code><a href="ref-preferred-browser-var.html">*preferred-browser*</a></code>.  A different value can be provided in
either your Common Lisp initialization file or in your personal
<code>gbbopen-init.lisp</code> file.  Changing the default setting in
<code>startup.lisp</code> is not recommended.
</p>
<p><a name="id9"></a><a target="_top" href="http://www.gnu.org/software/emacs/emacs.html">Emacs</a> access to the
GBBopen Hyperdoc is provided by
<var><i>&lt;</i>install-directory<i>&gt;</i></var><code>/browse-hyperdoc.el</code>.  This file defines
the interactive Emacs command <code>browse-hyperdoc</code> and binds it to
<code>META-?</code>.  To enable this command, load <code>browse-hyperdoc.el</code> from
your <code>.emacs</code> initialization file.
</p>
<p>If you already use the
<a target="_top" href="http://cvs.sourceforge.net/viewcvs.py/ilisp/ILISP/extra/hyperspec.el?rev=1.5&amp;view=auto">hyperspec.el</a>
utility (included with
<a target="_top" href="http://common-lisp.net/project/slime/">SLIME</a> and
<a target="_top" href="http://sourceforge.net/projects/ilisp/">ILISP</a>
distributions, but usable on its own), the Emacs
<code>browse-hyperdoc</code> command will automatically defer to the
<a target="_top" href="http://www.lispworks.com/documentation/HyperSpec/">Common Lisp  HyperSpec</a> when
given a non-GBBopen entity.  You can also download and install a local copy of the 
Common Lisp HyperSpec for use without a network connection.  In this case, set the value of <code>common-lisp-hyperspec-root</code> in your <code>.emacs</code> initialization file to point to your local copy of the HyperSpec.  For example:
</p>
<pre>
  (setf common-lisp-hyperspec-root "file:/usr/local/CLHS/")
</pre>
<p>Highly recommended!
</p>
<p><b><font size="+1">Entities</font></b>
</p>
<ul>
<li><a href="ref-preferred-browser-var.html"><font color="#000000">*preferred-browser*</font></a></li>
<li><a href="ref-define-tll-command.html"><font color="#000000">define-tll-command</font></a></li>
<li><a href="ref-startup-module.html"><font color="#000000">startup-module</font></a></li>
</ul>
<hr /><address><a target="_top" class="address"
    href="http://GBBopen.org/"><p>The GBBopen Project</a></address><br />
<table width="100%" cellpadding="0" cellspacing="2"><tr>
<td bgcolor="#99ccff"><a href="ref-acknowledgments.html"><img border="0" alt="Acknowledgments" src="previous.png"/></a></td><td bgcolor="#99ccff"><a href="reference_0.html"><img border="0" alt="Top" src="up.png"/></a></td><td bgcolor="#99ccff"><a href="ref-mini-module-entities.html"><img border="0" alt="Mini-Module System" src="next.png"/></a></td><td align="center" bgcolor="#99ccff" width="100%"><b>Starting Up</b></td><td bgcolor="#99ccff"><a target="_top" href="reference.html"><img border="0" alt="GoTo Top" src="top.png"/></a></td></tr></table></body></html>
